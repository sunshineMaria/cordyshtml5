<!DOCTYPE html> 
<html> 
	<head> 
	<title>Find Book</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
	<script src="../src/cordys.ajax.js" type="text/javascript"></script>	
	<script src="http://borismoore.github.com/jsrender/jsrender.js" type="text/javascript"></script>
	
	<style type="text/css">
		ui-block-a.top {width=80%}
	</style>


	<script id="bookTemplate" type="text/x-jsrender">
  		<li>
  			<div >
  				<a href="{{:accessInfo.webReaderLink}}" alt="{{:volumeInfo.description}}" class="ui-link-inherit">
				<img width="50%" src="{{:volumeInfo.imageLinks.smallThumbnail}}" >
				<h3 class="ui-li-heading">{{:volumeInfo.title}}, {{:volumeInfo.subtitle}}</h3>
				<p class="ui-li-desc">{{:volumeInfo.authors}}</p>
				</a>
			</div>
  		</li>
	</script>


	<script type="text/javascript">
            $("#mainPage").live('pageinit', function() {
			 });
            
			function searchBooks() {

					// get the books
					$.cordys.ajax({ url: "https://www.googleapis.com/books/v1/volumes?q=" + $('#searchTitle').val(),
						async: false,
						dataType: "jsonp",
						success: function(data) {
							var nrOfBooks = data.totalItems;

							var html = $("#bookTemplate").render(data.items);
							$('#booklist').append(html);
							$('#booklist').listview("refresh");
					    }, 
			
						error: function(response, error) {
							alert("Error: " + response + " : " + error)					
							$("#search-results").html("Unable to load search results.");
						}
					});
			}
	</script>
	


</head> 

<body> 

<div data-role="page" id="mainPage">

	<div data-role="header">
	   	<a href="http://www.cordys.com" data-icon="back">Back</a>
		<h1>Find book</h1>
	</div><!-- /header -->

	<input type="search" name="searchTitle" id="searchTitle" value="" placeholder="Type book title here..."/>
	<button id="btnSearch" type="submit" data-theme="b" onclick="searchBooks()">Search</button>

	<div data-role="content">
    	  <ul id="booklist" data-role="listview" data-theme="d" data-inset="true" data-dividertheme="c" data-counttheme="b" data-split-theme="a">
      	</ul>
	</div>
	
</div><!-- /page -->

</body>
</html>
